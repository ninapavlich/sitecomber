{% extends 'base.html' %}
{% block bodyclass %}{{block.super}} site-detail{% endblock %}

{% block inner %}
<nav aria-label="breadcrumb" class="my-4">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">All Sites</a></li>
    <li class="breadcrumb-item">
      <a href="{% url 'site-detail' object.pk %}"
        >{{object}}</a
      >
    </li>
    <li class="breadcrumb-item active" aria-current="page">Test Results</li>
  </ol>
</nav>

<article class="main">
  <h1>Test Results for {{object}}</h1>
  
  

  <div class="card text-dark">
    <div class="card-header">
      <ul class="nav nav-tabs card-header-tabs" role="tablist">
        
        {% for test_setting in object.sitetestsetting_set.all %}
        <li class="nav-item">
          <a
            class="nav-link {% if forloop.first %}active{% endif %}"
            href="#{{test_setting.test_name}}"
            role="tab"
            aria-controls="description"
            aria-selected="true"
            >{{test_setting.test_name}}</a
          >
        </li>
        {% endfor %}
        
      </ul>
    </div>
    <div class="card-body">
      <div class="tab-content mt-3">
        {% for test_setting in object.sitetestsetting_set.all %}

        <div class="tab-pane {% if forloop.first %}active{% endif %}" id="{{test_setting.test_name}}" role="tabpanel">
          
          <h4>Errors</h4>
          <ul class="list-unstyled">
            {% for result in object.page_test_results %}
            {% if result.test == test_setting.test and result.status == 'error'%}
            <li class="p-2 my-2 alert alert-{{result.bootstrap_class}}">
              <p class="my-0"><strong>{{result.page}}</strong></p>
              <p class="my-0"><small>{{result.page.url}}</small></p>
              <p class="my-0">{{result.message|safe}}</p>
            </li>
            {% endif %}
            {% endfor %}
          </ul>

          <h4>Warnings</h4>
          <ul class="list-unstyled">
            {% for result in object.page_test_results %}
            {% if result.test == test_setting.test and result.status == 'warning'%}
            <li class="p-2 my-2 alert alert-{{result.bootstrap_class}}">
              <p class="my-0"><strong>{{result.page}}</strong></p>
              <p class="my-0"><small>{{result.page.url}}</small></p>
              <p class="my-0">{{result.message|safe}}</p>
            </li>
            {% endif %}
            {% endfor %}
          </ul>

          <h4>Success</h4>
          <ul class="list-unstyled">
            {% for result in object.page_test_results %}
            {% if result.test == test_setting.test and result.status == 'success'%}
            <li class="p-2 my-2 alert alert-{{result.bootstrap_class}}">
              <p class="my-0"><strong>{{result.page}}</strong></p>
              <p class="my-0"><small>{{result.page.url}}</small></p>
              <p class="my-0">{{result.message|safe}}</p>
            </li>
            {% endif %}
            {% endfor %}
          </ul>

          <h4>Info</h4>
          <ul class="list-unstyled">
            {% for result in object.page_test_results %}
            {% if result.test == test_setting.test and result.status == 'info'%}
            <li class="p-2 my-2 alert alert-{{result.bootstrap_class}}">
              <p class="my-0"><strong>{{result.page}}</strong></p>
              <p class="my-0"><small>{{result.page.url}}</small></p>
              <p class="my-0">{{result.message|safe}}</p>
            </li>
            {% endif %}
            {% endfor %}
          </ul>
        </div>
        {% endfor %}


      </div>
    </div>
  </div>

</article>
{% endblock %}
